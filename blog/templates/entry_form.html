
{% extends "base.html" %}

{% block content %}
<h3>{{ action }}</h3>

<form method="POST">
    {{ form.hidden_tag() }}

    <div class="form-group">
        {{ form.title.label }}
        {{ form.title(class_="form-control") }}
    </div>

    <div class="form-group">
        {{ form.body.label }}
        {{ form.body(class_="form-control", cols="100", rows="20") }}
    </div>

    <div class="form-check">
        {{ form.is_published(class_="form-check-input") }}
        {{ form.is_published.label }}
    </div>

    {{ form.submit(class_="btn btn-primary mt-3") }}
</form>

{% if errors %}
<div class="alert alert-danger mt-3">
    <ul>
        {% for field, field_errors in errors.items() %}
            {% for error in field_errors %}
                <li>{{ error }}</li>
            {% endfor %}
        {% endfor %}
    </ul>
</div>
{% endif %}

<hr>

<h4>Opublikowane wpisy</h4>

{% for post in all_posts %}
<div class="card mb-3">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="card-title mb-0">{{ post.title }}</h5>

      <!-- Przyciski akcji: Edytuj i Usuń -->
      <div>
        <a href="{{ url_for('edit_entry', entry_id=post.id) }}" class="btn btn-sm btn-secondary me-1">
          Edytuj
        </a>

        <form action="{{ url_for('delete_entry', entry_id=post.id) }}" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-danger">
                Usuń
            </button>
        </form>
      </div>
    </div>

    <p class="card-subtitle text-muted">{{ post.pub_date.strftime('%Y-%m-%d') }}</p>
    <p class="card-text">{{ post.body }}</p>
  </div>
</div>
{% else %}
<p>Brak wpisów.</p>
{% endfor %}

{% endblock %}